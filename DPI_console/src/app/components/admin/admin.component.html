<p-table [value]="adminList" #dt3 [paginator]="true" [rows]="10" [loading]="loading" styleClass="p-datatable-gridlines"
    [globalFilterFields]="['username','email','nome','cognome','numeroTelefono']">
    <ng-template pTemplate="caption">
        <div class="space-between-flexItems">
            <div>
                <span class="p-input-icon-left p-ml-auto mr-8">
                    <i class="pi pi-search"></i>
                    <input pInputText type="text" (input)="dt3.filterGlobal($event.target.value, 'contains')"
                        placeholder="{{'ADMIN_CMP.CERCA' | translate}}" />
                </span>
                <!-- <button pButton label="{{'ADMIN_CMP.PULISCI' | translate}}" class="p-button-outlined"
                    icon="pi pi-filter-slash" (click)="clear(dt3)"></button> -->
            </div>
            <div>
                <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel(dt3)" label="Esporta"
                    class="p-button-success mr-8" pTooltip="XLS" tooltipPosition="bottom"></button>
                <button pButton label="{{'ADMIN_CMP.AGGIUNGI' | translate}}" class="p-button-success" icon="pi pi-plus"
                    (click)="onAddAdmin()"></button>
            </div>
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="username">{{'ADMIN_CMP.USERNAME' | translate}} <p-sortIcon field="username">
                </p-sortIcon>
                <p-columnFilter field="username" matchMode="contains" display="menu" [showMatchModes]="false"
                    [showOperator]="false" [showAddButton]="false">
                    <ng-template pTemplate="header">
                        <div class="margin-top-left-bold">
                            <span class="p-text-bold">Username</span>
                        </div>
                    </ng-template>
                </p-columnFilter>
            </th>
            <th pSortableColumn="email">{{'ADMIN_CMP.EMAIL' | translate}} <p-sortIcon field="email">
                </p-sortIcon>
                <p-columnFilter field="email" matchMode="contains" display="menu" [showMatchModes]="false"
                    [showOperator]="false" [showAddButton]="false">
                    <ng-template pTemplate="header">
                        <div class="margin-top-left-bold">
                            <span class="p-text-bold">Email</span>
                        </div>
                    </ng-template>
                </p-columnFilter>
            </th>
            <th pSortableColumn="nome">{{'ADMIN_CMP.NOME' | translate}} <p-sortIcon field="nome">
                </p-sortIcon>
                <p-columnFilter field="nome" matchMode="contains" display="menu" [showMatchModes]="false"
                    [showOperator]="false" [showAddButton]="false">
                    <ng-template pTemplate="header">
                        <div class="margin-top-left-bold">
                            <span class="p-text-bold">Nome</span>
                        </div>
                    </ng-template>
                </p-columnFilter>
            </th>
            <th pSortableColumn="cognome">{{'ADMIN_CMP.COGNOME' | translate}} <p-sortIcon field="cognome">
                </p-sortIcon>
                <p-columnFilter field="cognome" matchMode="contains" display="menu" [showMatchModes]="false"
                    [showOperator]="false" [showAddButton]="false">
                    <ng-template pTemplate="header">
                        <div class="margin-top-left-bold">
                            <span class="p-text-bold">Cognome</span>
                        </div>
                    </ng-template>
                </p-columnFilter>
            </th>
            <th>{{'ADMIN_CMP.PHONE' | translate}}
                <p-columnFilter field="numeroTelefono" matchMode="contains" display="menu" [showMatchModes]="false"
                    [showOperator]="false" [showAddButton]="false">
                    <ng-template pTemplate="header">
                        <div class="margin-top-left-bold">
                            <span class="p-text-bold">Numero di telefono</span>
                        </div>
                    </ng-template>
                </p-columnFilter>
            </th>
            <th>{{'ADMIN_CMP.COMMESSE_ADD' | translate}}
            </th>
            <th>{{'ADMIN_CMP.MODIFICA_PSW' | translate}}
            </th>
            <th>Operazioni
            </th>
            <!-- <th>{{'ADMIN_CMP.ELIMINA' | translate}}
            </th> -->
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-admin>
        <tr>
            <td class="break-word">{{admin.username}}</td>
            <td class="break-word">{{admin.email}}</td>
            <td>{{admin.nome}}</td>
            <td>{{admin.cognome}}</td>
            <td class="break-word">{{admin.numeroTelefono ? admin.numeroTelefono : '-'}}</td>
            <td><button pButton label="{{showTextButton ? ('ADMIN_CMP.COMMESSE_ADD_BTN' | translate) : ''}}" class="p-button-outlined p-button"
                    icon="pi pi-plus" (click)="onAssociaCommesse(admin)"></button></td>
            <td><button pButton label="{{showTextButton ? ('ADMIN_CMP.MODIFICA_PSW_BTN' | translate) : ''}}" class="p-button-outlined p-button"
                    icon="pi pi-key" (click)="onUpdateAdminPsw(admin.id)"></button></td>
            <td>
                <div class="btns-operazioni">

                    <button pButton  class="p-button-outlined p-button mr-8"
                        icon="pi pi-pencil" (click)="onUpdateAdmin(admin)"></button>
                    <button pButton 
                        class="p-button-outlined p-button-danger" icon="pi pi-times"
                        (click)="onDeleteAdmin(admin.id)"></button>
                </div>
            </td>
        </tr>
    </ng-template>
</p-table>
<!-- <p-toast></p-toast> -->

<p-dialog header="{{ 'ADMIN_CMP.MODIFICA_PSW' | translate}}" [modal]="true" [(visible)]="display">
    <div class="grid" *ngIf="display">
        <label for="password">
            {{'ADD_ADMIN_MODAL.NEW_PASSWORD' | translate}}*
        </label>
        <p-password class="change-password" id="password" [(ngModel)]="password" [toggleMask]="true"></p-password>
        <label for="passwordConfrim">
            {{'ADD_ADMIN_MODAL.CONF_PASSWORD' | translate}}*
        </label>
        <p-password [feedback]="false" class="change-password" id="passwordConfrim" [(ngModel)]="passwordConfrim"
            [toggleMask]="true"></p-password>
        <button pButton class="p-button" [disabled]="!disableChangePsw() || !password"
            label="{{'ADD_ADMIN_MODAL.CONFIRM' | translate}}" (click)="onConfirm()">
        </button>
    </div>
</p-dialog>

<p-confirmDialog header="{{ 'ADMIN_CMP.DEL_ADMIN' | translate}}" icon="pi pi-exclamation-triangle"></p-confirmDialog>